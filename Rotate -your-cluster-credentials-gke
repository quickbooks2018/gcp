# https://cloud.google.com/kubernetes-engine/docs/how-to/credential-rotation

export CLUSTER_NAME='cloudgeeks'

export PROJECT='playground-s-11-93276fa5'

export REGION='us-central1-c'

gcloud container clusters describe ${CLUSTER_NAME} --region ${REGION} --project ${PROJECT} \
    --format "value(masterAuth.clusterCaCertificate)" \
    | base64 --decode \
    | openssl x509 -text \
    | grep Validity -A 2


gcloud container clusters update ${CLUSTER_NAME} --region ${REGION} --project ${PROJECT} \
    --start-credential-rotation    


gcloud container operations list \
    --filter="operationType=UPGRADE_NODES AND status=RUNNING" --region ${REGION} --project ${PROJECT} \
    --format="value(name)"
   

kubectl get nodes -o wide
